---
title: 内嵌汇编
date: 2020-07-25 10:37:04
tags: OS
---

__asm__ __violate__ ("movl %1,%0" : "=r" (result) : "m" (input) : "ebx");

1. =r 指明返回的结果：最后会将eax中的内容拷贝到result变量中
2. m： 指明输入的内容来自内存，从input变量中拷贝
3. %1, %0: 指明参数的顺序： 这样指令展开的时候会成： movl (input分配的寄存器) (result分配的寄存器) 
4. ebx 破坏描述部分，显式的说明会破坏哪些寄存器的值


2020/08/02:
x64架构下，gas汇编器push/pop只能操作16bit或64bit的寄存器，对应的指令为: push/pushq
ref: https://stackoverflow.com/questions/21679131/error-invalid-instruction-suffix-for-push